const socket=io("/"),videoGrid=document.getElementById("video-grid"),myPeer=new Peer(void 0,{host:"/",port:"3001"}),myVideo=document.createElement("video");myVideo.muted=!0;const peers={};navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(a=>{addVideoStream(myVideo,a),myPeer.on("call",b=>{b.answer(a);const c=document.createElement("video");b.on("stream",a=>{addVideoStream(c,a)})}),socket.on("user-connected",b=>{connectToNewUser(b,a)})}),socket.on("user-disconnected",a=>{peers[a]&&peers[a].close()}),myPeer.on("open",a=>{socket.emit("join-room",ROOM_ID,a)});function connectToNewUser(a,b){const c=myPeer.call(a,b),d=document.createElement("video");c.on("stream",a=>{addVideoStream(d,a)}),c.on("close",()=>{d.remove()}),peers[a]=c}function addVideoStream(a,b){a.srcObject=b,a.addEventListener("loadedmetadata",()=>{a.play()}),videoGrid.append(a)}